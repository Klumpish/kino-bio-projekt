(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();class v{constructor(e){this.apiBackend=e}async CardGenerator(e=1){const t=document.querySelector(".movies__list");(await this.apiBackend.loadAllFilms()).sort((n,o)=>o.rating-n.rating).slice(0,e).forEach(n=>{const o=document.createElement("li");o.classList="movies__list-item";const a=document.createElement("article");a.classList="movie-card",a.setAttribute("id",`${n.id}`),a.setAttribute("aria-label",`${n.title}`);const c=document.createElement("img");c.classList="movie-card__image",c.src=`${n.image}`,c.alt=`Omslag för filmen ${n.title}`,c.setAttribute("aria-hidden","false");const u=document.createElement("h3");u.classList="movie-card__title",u.textContent=`${n.title}`;const l=document.createElement("time");l.classList="movie-card__date",l.setAttribute("aria-label",`Premiär ${n.date}`),l.textContent=`${n.date}`;const d=document.createElement("button");d.classList="movie-card__button",d.textContent="Boka biljett",d.setAttribute("aria-label","Boka biljett");const m=document.createElement("span");m.classList="movie-card__genre",m.textContent=`${n.genre}`,m.setAttribute("aria-label",`Genre: ${n.genre}`),a.appendChild(c),a.appendChild(u),a.appendChild(l),a.appendChild(m),a.appendChild(d),o.appendChild(a),t.appendChild(o)})}}class h extends EventTarget{constructor(e){super(),this.searchString=e}doesFilmMatch(e){var n,o,a,c;if(!this.searchString)return!0;const t=((o=(n=e==null?void 0:e.data)==null?void 0:n.title)==null?void 0:o.toLowerCase())||"",r=((c=(a=e==null?void 0:e.data)==null?void 0:a.description)==null?void 0:c.toLowerCase())||"",s=this.searchString.toLowerCase();return t.includes(s)||r.includes(s)}render(){const e=document.createElement("div");e.className="moviesSecond__search";const t=document.createElement("input");return t.placeholder="Sök film",t.addEventListener("keyup",()=>{this.searchString=t.value,this.dispatchEvent(new Event("change"))}),e.append(t),e}}class _ extends EventTarget{constructor(e){super(),this.backend=e}async start(e){const t=await this.backend.loadAllFilms();this.filter=new h(""),this.filter.addEventListener("change",()=>{this.update()});const r=this.filter.render();e.append(r);const s=document.createElement("ul");s.className="moviesSecond__list",e.append(s),this.films=t.map(n=>{const o=this.renderFilm(n);return s.append(o),{data:n,elem:o}})}update(){this.films.forEach(({data:e,elem:t})=>{const r=this.filter.doesFilmMatch({data:e});t.style.display=r?"block":"none"})}renderFilm(e){const t=document.createElement("li");return t.classList.add("moviesSecond__list__elem"),t.innerHTML=`
        <img src="${e.image}" class="moviesSecond__list__elem__image"  alt="${e.title}">
        <h3 class="moviesSecond__list__elem__title">${e.title}</h3>
        <p class="moviesSecond__list__elem__desc">${e.desc} <strong>(${e.year})</strong></p>
        <p class="moviesSecond__list__elem__rating">Rating: ${e.rating}</p>
        <p class="moviesSecond__list__elem__date">Datum: ${e.date}</p>
        <p class="moviesSecond__list__elem__price">Pris: ${e.price}SEK</p>
        <p class="moviesSecond__list__elem__seat">Platser: ${e.seatsAvailable}</p>
    `,t}}class p{constructor(e){this.apiUrl=e}async loadAllFilms(){const e=await fetch(this.apiUrl+"/movies");if(!e.ok)throw new Error(`Failed to fetch movies: ${e.statusText}`);const t=await e.json();return console.log(t),t}}document.addEventListener("DOMContentLoaded",()=>{const i=document.querySelector(".hamburger"),e=document.querySelector(".hamburger__items"),t=document.querySelector(".hamburger__close");i&&e&&i.addEventListener("click",()=>{e.classList.toggle("active"),i.classList.toggle("open")}),t&&t.addEventListener("click",()=>{e.classList.remove("active"),i.classList.remove("open")})});class g{constructor(e){this.apiPath=e}async fetchData(){try{return(await(await fetch(this.apiPath)).json()).liveEvents}catch(e){return console.error("Error fetching data:",e),[]}}}class f{constructor(e){this.container=document.querySelector(e)}createLiveEvent({title:e,description:t,image:r}){const s=document.createElement("li");return s.classList.add("live__list-item"),s.innerHTML=`
        <div class="live__list-item-image-wrapper">
                <img src="${r}" class="live__list-item-image" alt="${e}" />
            </div>
            <div class="live__list-item-title">
                <h3>${e}</h3>
                <button class="live__list-item-btn" aria-label="Book ticket to live event">BOKA</button>
            </div>
            <div class="live__list-item-description">
                <p>${t}</p>
            </div>
            `,s}renderLiveEvents(e){if(!this.container){console.error("Container element not found");return}if(!Array.isArray(e)||e.length===0){this.container.innerHTML="<p> No live events founds.</p>";return}this.container.innerHTML="";const t=document.createDocumentFragment();e.forEach(r=>{const s=this.createLiveEvent(r);t.appendChild(s)}),this.container.appendChild(t)}}async function L(){const i="./assets/json/liveEvents.json",e=new g(i),t=new f(".live__list");try{const r=await e.fetchData();t.renderLiveEvents(r)}catch(r){console.error("Error initializing live events:",r)}}if(document.querySelector(".moviesSecond")){const i=document.createElement("h4");i.classList.add("movies__message__new"),i.innerText=`Api is starting
Loading movies... Please wait.`,document.querySelector(".movies__message").appendChild(i),i.style.display="none";const e=new p("https://kino-bio-projekt.onrender.com");console.log("Link to API:"+e);const t=new _(e),r=document.querySelector(".moviesSecond");t.start(r,i)}else{const i=new p("https://kino-bio-projekt.onrender.com");new v(i).CardGenerator(4)}document.addEventListener("DOMContentLoaded",L);
